#!/bin/bash
set -Eeuo pipefail

FIRST_PARAM=${1:-}
AHEAD=$(git rev-list --left-right --count origin/master.. | cut -f2)

if [ "$AHEAD" -eq 0 ]; then
    AHEAD=1
fi

clear
files=$(
    git log -p -"${FIRST_PARAM:-$AHEAD}" --name-status --oneline |
        awk '$1 ~ /^[a-zA-Z]$/ && $1 != "D" && NR != 1 {print $2}' |
        tr '\n' ' '
)

eval "${EDITOR:-vim} $files"
